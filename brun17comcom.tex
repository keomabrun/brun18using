\documentclass{elsarticle}

\usepackage{amsmath}
\usepackage{graphics}
\usepackage{graphicx}
\usepackage{color}
\usepackage{xspace}
\usepackage{url}
\usepackage[utf8]{inputenc}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{subcaption}

% reviews
\newcommand{\todo}[1]        {\textcolor{red}{[TODO] #1}}
\newcommand{\keoma}[1]       {\textcolor{blue}{[Keoma] #1}}
\newcommand{\remy}[1]        {\textcolor{blue}{[Remy] #1}}
\newcommand{\xavi}[1]        {\textcolor{blue}{[Xavi] #1}}
\newcommand{\thomas}[1]      {\textcolor{blue}{[Thomas] #1}}

 % lorem
\newcommand{\lorem}          {\textcolor{green}{Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.}}

% shortcuts
\newcommand{\smip}                {SmartMesh~IP\xspace}
\newcommand{\HRNEIGHBORS}         {{\tt HR\_NEIGHBORS}\xspace}
\newcommand{\HRDISCOVERED}        {{\tt HR\_DISCOVERED}\xspace}
\newcommand{\HRDEVICE}            {{\tt HR\_DEVICE}\xspace}
\newcommand{\pathcreate}          {{\tt path\_create}\xspace}
\newcommand{\pathdelete}          {{\tt path\_delete}\xspace}
\newcommand{\motecreate}          {{\tt mote\_create}\xspace}
\newcommand{\moteId}              {{\tt moteId}\xspace}
\newcommand{\PEACHNUMHRNEIGHBORS}      {140,897\xspace}
\newcommand{\PEACHNUMSTATS}            {369,276\xspace}

\graphicspath{{figures/}}

\begin{document}
	
\begin{frontmatter}
    
\date{}
	
\title{(Not so) Intuitive Results from two Real-World\\Low-Power Wireless Mesh Deployments}

\author[inria]{Keoma~Brun-Laguna}
	\ead{keoma.brun@inria.fr}
\author[inria]{R\'emy~L\'eone}
    \ead{remy.leone@inria.fr}
\author[uoc]{Xavier~Vilajosana}
    \ead{xvilajosana@uoc.edu}
\author[inria]{Thomas~Watteyne}
    \ead{thomas.watteyne@inria.fr}

\address[inria]{Inria, EVA team, Paris, France}
\address[uoc]{Univ. Oberta de Catalunya, Barcelona, Catalonia, Spain}



\begin{abstract}
Two wireless network sensors are deployed.
One in a peach orchard and one in a office building.
The two networks are collecting sensor values and network statistics.
This paper presents an in-depth analysis of the statistics, in order to precisely understand the performance of the network.
Nodes in the network exhibit an expected lifetime between 4 and 16~years, with an end-to-end reliability of 100\%.
We show how -- contrary to popular belief -- wireless links are symmetric.
Thanks to the use of Time Slotted Channel Hopping (TSCH), the network topology is very stable, with $\leq$5 link changes per day in the entire network.
\end{abstract}

\begin{keyword}
    WSN, SmartAgriculture, SmartBuilding
\end{keyword}

\end{frontmatter}

%==============================================================================

%======== front-page figure, do not move
\begin{figure}
    \centering
    \includegraphics[width=0.8\textwidth]{orchard}
    \caption{Areal view of the sensor network deployed in the orchard near Mendoza, Argentina.}
    \label{fig:orchard}
\end{figure}

\section{Introduction}
\label{sec:intro}

% the problem

Peaches do not like frost.
If during the blooming season (September in Argentina), temperature gets below $-$3~C for only a couple of hours, the flowers freeze, and no peaches are produced.
In 2013, 85\% of the peach production in the Mendoza region (western Argentina) was lost because of frost events.
Farmers can lose everything in only a couple of hours.
Yet, if they are warned of a frost event a couple of hours ahead, they can install heaters throughout the orchards, and use big fans to move the hot air around.
Fighting the frost events is not the issue, what is hard is predicting it.

% the PEACH project

The goal of the PEACH project~\cite{watteyne16peach} is to predict frost events.
We install sensors around the orchard that measure air temperature, air relative humidity, soil moisture and soil temperature.
We feed the collected data into a database, and by analyzing the data in real-time using machine learning, we identify patterns in the data and predict frost events.

% the architecture

Because of the heavy machinery that moves inside the orchard, using cables to interconnect the sensors is not an option.
The main challenge is to deploy a system that provides both a high end-to-end reliability and a long lifetime without using cables.
We use \smip, an off-the-shelf low-power wireless mesh solution from Linear Technology.
The sensor devices are battery-powered and equipped with a radio.
They form a multi-hop topology, and collaborate to route the data generated by the devices (called ``motes'') to a gateway.
This gateway is connected to the Internet, and forwards the gathered date to the servers in Paris, France.
Data appears on the web interface of the servers seconds after it was gathered by the sensor network.

% the deployment

The network is deployed in a peach orchard of 204~trees, planted in a 50~m~$\times$~100~m area (shown in Fig.~\ref{fig:map}).
The low-power wireless network is composed of 18~sensor motes\footnote{2 motes malfunctioned and are not present on the map.} uniformly distributed between the peach trees, and 3~relay motes to connect the orchard to the gateway some 300~m away.
Each mote is placed in a water-tight box that is fixed on a 4~m high pole (see Fig.~\ref{fig:orchard}).

\begin{figure}
    \begin{minipage}[b]{0.66\textwidth}
        \centering
        \includegraphics[width=\textwidth]{map_annotated}
        \caption{The wireless motes deployed in the peach orchard in Mendoza, Argentina.\newline}
    \end{minipage}
    \hfill
    \begin{minipage}[b]{0.3\textwidth}
        \includegraphics[width=\textwidth]{evalab_map_annotated.eps}
        \caption{The wireless motes deployed in the Inria office building, France.}
    \end{minipage}
    \label{fig:map}
\end{figure}

% hardware

In the peach orchard we use four types of \smip devices.
The 2 DC9018 boards feature an external antenna; the 16 DC9003 boards a chip antenna.
These are deployed inside the orchard.
We deploy 3 repeaters outside the orchards to connect the orchard to the gateway.
For the two deployments, the gateway is composed of a Raspberry~Pi single-board computer, and a DC2274 \smip manager.

% technology

The \smip network implements the IEEE802.15.4e standard~\cite{std_ieee802154e_2012}, which includes a channel hopping mechanism to reduce the impact of multipath fading and external interference.
This allows the network to be highly reliable, stable, and extremely low power~\cite{watteyne10mitigating, watteyne09reliability}.

% the data

Each mote produces a temperature value every 30~s, and network statistics every 5~min.
In 3~months of operation, we gathered over 4~million temperature values, and more than 350,000~network statistics.

% the goal of this paper

The goal of this paper is to analyze the network statistics over a 3-month period, and precisely assess the performance of the network.
\newpage
This paper makes the following contributions:
\begin{itemize}
    \item We confirm that the \smip network exhibits years of battery lifetime and wire-like reliability;
    \item We show that channel hopping causes the network topology to be very stable, with $\leq$5 link changes per day;
    \item Contrary to popular belief, we show that links in the network are symmetric, i.e.~they exhibit the same signal strength in both directions of the same link.
\end{itemize}

% paper organisation

The remainder of this paper is organized as follows.
Section~\ref{sec:collected} describes what statistics we are collecting, and the amount of statistics collected over two periods of 3~months.
Section~\ref{sec:intuitive} presents results that confirm assumptions about what we can expect for real-world \smip deployment.
Section~\ref{sec:notsointuitive} presents not so intuitive results about link symmetry and network stability.
Finally, Section~\ref{sec:conclusion} concludes this paper and discusses further improvements.

%==============================================================================
\section{Statistics Collected}
\label{sec:collected}

% environment

The wireless network is deployed in a peach orchard in Junin, 45~km South-East of Mendoza in Western Argentina.
No other electronic devices are present in the field.
Farmers work inside the field with heavy machinery for 1-2~h every 20~days approximately.
In the region, air temperature ranges between $-$9~C in winter (May-October) to +38~C in summer (November-April).
Because of the sunny weather, day/night temperature swings of 10+~C are not uncommon in winter.

% events and HR

Each device in the network produces both sensor data and network statistics.
Network statistics can be separated in Events and Health Reports messages.
\textit{Event} messages are non-periodic notifications the network sends when a network event happens (e.g.~a node joins/leaves the network, a link is created/deleted).
\textit{Health Report} (HR) messages are sent periodically by each mote; they contain counters and statistics about that mote.
HRs are used to assess the overall health of the network.

% number received and remainder

Table~\ref{tab:msg_stats} summarizes the number of events and HRs gathered during the 3~month period.
In the remainder of this section, we detail the meaning of each of the statistics.

\begin{table}
    \centering
    \begin{tabular}{|l|r|r|}
        \toprule
        \multicolumn{1}{|c|}{type} & \multicolumn{1}{|c|}{PEACH} & \multicolumn{1}{|c|}{EVAlab} \\ \hline
        \hline
        \motecreate     &     133     &   85 \\ \hline
        \pathcreate     &   4,098     &   2,149 \\ \hline
        \pathdelete     &   3,653     &   2,070 \\ \hline
        \HRDEVICE       & 132,758     &   144,270 \\ \hline
        \HRDISCOVERED   &  87,737     &   126,906 \\ \hline
        \HRNEIGHBORS    & \PEACHNUMHRNEIGHBORS & 144,217\\ \hline
    \end{tabular}
    \caption{The number of statistics collected over the 3~month period.}
    \label{tab:msg_stats}
\end{table}

% analysis

\lorem

%==============================================================================
\section{Intuitive Results}
\label{sec:intuitive}

\lorem

%------------------------------------------------------------------------------
\subsection{RSSI vs. Distance}
\label{sec:rssi_distance}

\lorem

\begin{figure}[h]
    \includegraphics[width=0.5\columnwidth]{pister_hack_peach.eps}
    \includegraphics[width=0.5\columnwidth]{pister_hack.eps}
    \caption{RSSI measurements are roughly located between the Friis model and the Friis model shifted by $-$40~dB.}
    \label{fig:pister_hack}
\end{figure}

%------------------------------------------------------------------------------
\subsection{Wireless Waterfall}
\label{sec:waterfall}

% sample presentation

\lorem

% plot

\begin{figure}
    \includegraphics[width=0.5\columnwidth]{waterfall_peach.eps}
    \includegraphics[width=0.5\columnwidth]{waterfall.eps}  
    \caption{
        The PDR/RSSI ``waterfall'' plot.
    }
    \label{fig:waterfall}
\end{figure}

\lorem

% interferences

\lorem

%------------------------------------------------------------------------------
\subsection{End-to-End Reliability}
\label{sec:net_reliability}

% steady state results

\lorem

\begin{table}
    \begin{tabular}{|l|l|l|}
        \hline
        {}	 							& PEACH 				  & EVALAB \\
        \hline
        reliability (Arrived/Lost) 		& 100\% (693,844/0) 	  & (419,612/not measured)\\ \hline
        average PDR (Transmit/Fails) 	& 95\% (4,405,569/258778) & 85\% (22,869,461/3,412,059)\\ \hline
        latency     					& 700~msec 				  & Not measured\\
        \hline
    \end{tabular}
    \caption{The overall network performance in the 15-25 July 2016 period.}
    \label{tab:net_stats_peach}
\end{table}

\lorem

%------------------------------------------------------------------------------
\subsection{Network Lifetime}
\label{sec:lifetime}

% description

\lorem

% results

\lorem

\begin{table}
\begin{subtable}{.4\textwidth}
    \begin{tabular}{|c|c|r|}
        \toprule
        MAC    & charge consumed           &   lifetime \\
        \midrule
        \tt{30-60-ef}  & 227,847~C (2.2\%) & 11~years \\
        \tt{38-0f-66}  & 252,356~C (2.5\%) & 10~years \\
        \tt{3f-f8-20}  & 291,312~C (2.9\%) & 8~years \\
        \tt{3f-fe-87}  & 392,606~C (3.9\%) & 6~years \\
        \tt{3f-fe-88}  & 458,459~C (4.5\%) & 5~years \\
        \tt{58-32-36}  & 327,634~C (3.2\%) & 8~years \\
        \tt{60-01-f8}  & 252,454~C (2.5\%) & 10~years \\
        \tt{60-02-1b}  & 222,253~C (2.2\%) & 10~years \\
        \tt{60-02-4b}  & 146,068~C (1.4\%) & 17~years \\
        \tt{60-03-82}  & 494,841~C (4.9\%) & 5~years \\
        \tt{60-05-5f}  & 274,502~C (2.7\%) & 9~years \\
        \tt{60-05-69}  & 437,136~C (4.3\%) & 6~years \\
        \tt{60-05-78}  & 304,145~C (3.0\%) & 8~years \\
        \tt{60-05-ab}  & 284,764~C (2.8\%) & 9~years \\
        \tt{60-06-27}  & 321,879~C (3.2\%) & 8~years \\
        \tt{60-08-d5}  & 263,120~C (2.6\%) & 9~years \\
        \bottomrule
    \end{tabular}
    \caption{PEACH}
\end{subtable}\hfill
\begin{subtable}{.45\textwidth}
\begin{tabular}{|c|c|c|}
    \toprule
    MAC &  charge consumed & lifetime \\
    \midrule
    \tt{38-03-dd} &  565,552 C (7.1\%)  &  4 years \\
    \tt{58-e9-ca} &  439,811 C (5.6\%)  &  5 years \\
    \tt{58-e9-cb} &  457,318 C (5.8\%)  &  5 years \\
    \tt{58-eb-5b} &  471,838 C (6.0\%)  &  4 years \\
    \tt{58-eb-64} &  361,830 C (4.6\%)  &  6 years \\
    \tt{58-eb-67} &  497,978 C (6.3\%)  &  4 years \\
    \tt{58-f3-17} &  383,552 C (4.8\%)  &  5 years \\
    \tt{58-f4-f8} &  428,316 C (5.4\%)  &  5 years \\
    \tt{58-f5-23} &  464,164 C (5.9\%)  &  4 years \\
    \tt{58-f5-3c} &  463,003 C (5.8\%)  &  4 years \\
    \tt{58-f5-58} &  428,718 C (5.4\%)  &  5 years \\
    \tt{58-f8-8f} &  468,257 C (5.9\%)  &  4 years \\
    \tt{58-f9-c4} &  347,970 C (4.4\%)  &  6 years \\
    \bottomrule
\end{tabular}
\caption{EVAlab}
\end{subtable}\hfill
\caption{Per-node power consumption and associated expected lifetime when powered by a pair of AA batteries.}
\label{tab:stats_charge}
\end{table}
%==============================================================================
\section{Not so Intuitive Results}
\label{sec:notsointuitive}

\lorem

%------------------------------------------------------------------------------
\subsection{Link (A)Symmetry}
\label{sec:symmetry}

% what is reported

\lorem

% what is asymmetry

\lorem

% what we measure

\lorem
\begin{figure}
    \includegraphics[width=0.5\columnwidth]{asymmetry_peach.eps}
    \includegraphics[width=0.5\columnwidth]{asymmetry.eps}
    \caption{
        The difference in RSSI between the two directions of 20~wireless links
        (links continuously active in the 18-25 June 2016 period).
        The average value (the bar) is complemented with the standard deviation.
        The color of the bar indicates sample size.
    }
    \label{fig:tab_symmetry}
\end{figure}

% discussion

\lorem

%------------------------------------------------------------------------------
\subsection{Network Stability}
\label{sec:net_stability}

% unreliability

\lorem

% time scale

\lorem

% dataset

\lorem

% results

\lorem

\begin{figure}
    \includegraphics[width=0.5\columnwidth]{net_churn_peach.eps}
    \includegraphics[width=0.5\columnwidth]{net_churn.eps}
    \caption{
        Network stability: the number of \pathcreate and \pathdelete events generated per day over a 16-day period.
        The top portion shows the total number of links.
    }
    \label{fig:net_churn}
\end{figure}

% discussion

\lorem

%==============================================================================
\section{Conclusion}
\label{sec:conclusion}

% intro

\lorem

% intuitive

\lorem

% non-intuitive

\lorem

% conclusion

\lorem

%==============================================================================
%\bibliographystyle{abbrv}
%\bibliography{brun16intuitive}

\begin{thebibliography}{10}

\bibitem{std_ieee802154_2011}
{802.15.4-2011: IEEE Standard for Local and metropolitan area networks. Part
  15.4: Low-Rate Wireless Personal Area Networks (LR-WPANs)}, 5 September 2011.

\bibitem{std_ieee802154e_2012}
{802.15.4e-2012: IEEE Standard for Local and metropolitan area networks--Part
  15.4: Low-Rate Wireless Personal Area Networks (LR-WPANs) Amendment 1: MAC
  sublayer}, 16 April 2012.

\bibitem{rfc3626}
T.~H. Clausen and P.~Jacquet.
\newblock {Optimized Link State Routing Protocol (OLSR)}, October 2003.

\bibitem{smip_app_note}
Linear Technology.
\newblock {\em {SmartMesh IP Application Notes}}, 2015.

\newpage

\bibitem{saunders07antennas}
S.~R. Saunders and A.~Arag\'on-Zavala.
\newblock {\em {Antennas and Propagation for Wireless Communication Systems}}.
\newblock Wiley-Blackwell, 2nd edition, 2007.

\bibitem{srinivasan08beta}
K.~Srinivasan, M.~A. Kazandjieva, S.~Agarwal, and P.~Levis.
\newblock {The $\beta$-factor: Measuring Wireless Link Burstiness}.
\newblock In {\em Conference on Embedded Network Sensor Systems (SenSys)},
  pages 29--42, Raleigh, NC, USA, 2008. ACM.

\bibitem{watteyne16peach}
T.~Watteyne, A.~L. Diedrichs, K.~Brun-Laguna, J.~E. Chaar, D.~Dujovne, J.~C.
  Taffernaberry, and G.~Mercado.
\newblock {PEACH: Predicting Frost Events in Peach Orchards Using IoT
  Technology}.
\newblock {\em {EAI Endorsed Transactions on the Internet of Things}}, June
  2016.

\bibitem{watteyne10mitigating}
T.~Watteyne, S.~Lanzisera, A.~Mehta, and K.~S. Pister.
\newblock {Mitigating Multipath Fading through Channel Hopping in Wireless
  Sensor Networks}.
\newblock In {\em IEEE International Conference on Communications (ICC)}, pages
  1--5, Cape Town, South Africa, 23-27 May 2010. IEEE.

\bibitem{watteyne09reliability}
T.~Watteyne, A.~Mehta, and K.~Pister.
\newblock {Reliability Through Frequency Diversity: Why Channel Hopping Makes
  Sense}.
\newblock In {\em International Symposium on Performance Evaluation of Wireless
  Ad Hoc, Sensor, and Ubiquitous Networks (PE-WASUN)}, pages 116--123,
  Tenerife, Canary Islands, Spain, 26-30 October 2009. ACM.

\bibitem{watteyne15industrial}
T.~Watteyne, J.~Weiss, L.~Doherty, and J.~Simon.
\newblock {Industrial IEEE802.15.4e Networks: Performance and Trade-offs}.
\newblock In {\em International Conference on Communications (ICC), Internet of
  Things Symposium}, London, UK, 8-12 June 2015. IEEE.

\bibitem{zats10wireless}
S.~Zats.
\newblock {Wireless Sensor Networks Scaling and Deployment in Industrial
  Automation}.
\newblock Master's thesis, University of California, Berkeley, 13 May 2010.

\end{thebibliography}

\end{document}
